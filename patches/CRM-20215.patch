From 4f7a04b279025240ed8a6523aec30ec37ad2b9d6 Mon Sep 17 00:00:00 2001
From: Dave Jenkins <davej+git@circle-interactive.co.uk>
Date: Fri, 26 May 2017 17:28:05 +0100
Subject: [PATCH] Improve Views checkbox value handling

---
 modules/views/civicrm/civicrm_handler_filter_custom_option.inc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/modules/views/civicrm/civicrm_handler_filter_custom_option.inc b/modules/views/civicrm/civicrm_handler_filter_custom_option.inc
index 98a83ab5e..1891229fa 100644
--- a/modules/views/civicrm/civicrm_handler_filter_custom_option.inc
+++ b/modules/views/civicrm/civicrm_handler_filter_custom_option.inc
@@ -84,7 +84,7 @@ class civicrm_handler_filter_custom_option extends views_handler_filter_in_opera
     $op = ($this->operator == 'in' || $this->operator == 'all') ? 'LIKE' : 'NOT LIKE';
     $glue = ($this->operator == 'in') ? 'OR ' : 'AND ';
     foreach ($this->value as $value) {
-      $clauses[] = "$this->table_alias.$this->real_field " . $op . " '%" . $sep . $value . $sep . "%' ";
+      $clauses[] = "$this->table_alias.$this->real_field " . $op . " '%" . $sep . CRM_Core_DAO::escapeString($value) . $sep . "%' ";
     }
     $clause = implode($glue, $clauses);
     $this->query->add_where_expression($this->options['group'], $clause);
